more malloc and memory managment
